#!/bin/sh

T="docker-emulator"

{ docker build \
         -q \
         -t "${T:?}" \
         - \
         >/dev/null <<"EOF"
FROM debian:buster
## Refs:
## - [apt-get best practices](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#apt-get).
RUN apt-get update && apt-get install -y --no-install-recommends \
    python3-pip \
    python3-setuptools \
 && rm -rf /var/lib/apt/lists/*
RUN pip3 install sdkmanager==0.3
WORKDIR /workdir
ENTRYPOINT ["find", "/", "-name", "sdkmanager"]
EOF
} && {
    # shellcheck disable=SC2094
    docker run \
           -i \
           -a stdin \
           -a stdout \
           -a stderr \
           --network none \
           --rm \
           "${T:?}"; }
